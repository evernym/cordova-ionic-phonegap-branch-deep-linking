{"version":3,"sources":["afterPrepareHook.js"],"names":[],"mappings":";;AAAA;;;;;;;AAOA,IAAI,eAAe,QAAQ,0BAAR,CAAnB;AAAA,IACE,wBAAwB,QAAQ,iCAAR,CAD1B;;AAEE;AACA,yBAAyB,QAAQ,kCAAR,CAH3B;AAAA,IAIE,wBAAwB,QAAQ,+BAAR,CAJ1B;AAAA,IAKE,UAAU,SALZ;AAAA,IAME,MAAM,KANR;;AAQA,OAAO,OAAP,GAAiB,UAAS,GAAT,EAAc;AAC7B,MAAI,GAAJ;AACD,CAFD;;AAIA;;;;;AAKA,SAAS,GAAT,CAAa,cAAb,EAA6B;AAC3B,MAAI,oBAAoB,aAAa,eAAb,CAA6B,cAA7B,CAAxB;AAAA,MACE,gBAAgB,eAAe,IAAf,CAAoB,SADtC;;AAGA;AACA,MAAI,qBAAqB,IAAzB,EAA+B;AAC7B;AACD;;AAED;AACA,MAAI,kBAAkB,KAAlB,IAA2B,IAA3B,IAAmC,kBAAkB,KAAlB,CAAwB,MAAxB,IAAkC,CAAzE,EAA4E;AAC1E,YAAQ,IAAR,CAAa,sFAAb;AACA;AACD;;AAED,gBAAc,OAAd,CAAsB,UAAS,QAAT,EAAmB;AACvC,YAAQ,QAAR;AACE,WAAK,OAAL;AAAc;AACV,0CAAgC,cAAhC,EAAgD,iBAAhD;AACA;AACD;AACH,WAAK,GAAL;AAAU;AACN,sCAA4B,cAA5B,EAA4C,iBAA5C;AACA;AACD;AARL;AAUD,GAXD;AAYD;;AAED;;;;;;AAMA,SAAS,+BAAT,CAAyC,cAAzC,EAAyD,iBAAzD,EAA4E;AAC1E;AACA,wBAAsB,gBAAtB,CAAuC,cAAvC,EAAuD,iBAAvD;AAED;;AAED;;;;;;AAMA,SAAS,2BAAT,CAAqC,cAArC,EAAqD,iBAArD,EAAwE;AACtE;AACA,wBAAsB,kCAAtB,CAAyD,cAAzD;;AAEA;AACA,yBAAuB,qCAAvB,CAA6D,cAA7D,EAA6E,iBAA7E;AAED","file":"afterPrepareHook.js","sourcesContent":["/**\nHook is executed at the end of the 'prepare' stage. Usually, when you call 'cordova build'.\n\nIt will inject required preferences in the platform-specific projects, based on <branch-config>\ndata you have specified in the projects config.xml file.\n*/\n\nvar configParser = require('./lib/configXmlParser.js'),\n  androidManifestWriter = require('./lib/android/manifestWriter.js'),\n  // androidWebHook = require('./lib/android/webSiteHook.js'),\n  iosProjectEntitlements = require('./lib/ios/projectEntitlements.js'),\n  iosProjectPreferences = require('./lib/ios/xcodePreferences.js'),\n  ANDROID = 'android',\n  IOS = 'ios';\n\nmodule.exports = function(ctx) {\n  run(ctx);\n};\n\n/**\n * Execute hook.\n *\n * @param {Object} cordovaContext - cordova context object\n */\nfunction run(cordovaContext) {\n  var pluginPreferences = configParser.readPreferences(cordovaContext),\n    platformsList = cordovaContext.opts.platforms;\n\n  // if no preferences are found - exit\n  if (pluginPreferences == null) {\n    return;\n  }\n\n  // if no host is defined - exit\n  if (pluginPreferences.hosts == null || pluginPreferences.hosts.length == 0) {\n    console.warn('No host is specified in the config.xml. Universal Links plugin is not going to work.');\n    return;\n  }\n\n  platformsList.forEach(function(platform) {\n    switch (platform) {\n      case ANDROID: {\n          activateUniversalLinksInAndroid(cordovaContext, pluginPreferences);\n          break;\n        }\n      case IOS: {\n          activateUniversalLinksInIos(cordovaContext, pluginPreferences);\n          break;\n        }\n    }\n  });\n}\n\n/**\n * Activate Deep Links for Android application.\n *\n * @param {Object} cordovaContext - cordova context object\n * @param {Object} pluginPreferences - plugin preferences from the config.xml file. Basically, content from <branch-config> tag.\n */\nfunction activateUniversalLinksInAndroid(cordovaContext, pluginPreferences) {\n  // inject preferenes into AndroidManifest.xml\n  androidManifestWriter.writePreferences(cordovaContext, pluginPreferences);\n\n}\n\n/**\n * Activate Universal Links for iOS application.\n *\n * @param {Object} cordovaContext - cordova context object\n * @param {Object} pluginPreferences - plugin preferences from the config.xml file. Basically, content from <branch-config> tag.\n */\nfunction activateUniversalLinksInIos(cordovaContext, pluginPreferences) {\n  // modify xcode project preferences\n  iosProjectPreferences.enableAssociativeDomainsCapability(cordovaContext);\n\n  // generate entitlements file\n  iosProjectEntitlements.generateAssociatedDomainsEntitlements(cordovaContext, pluginPreferences);\n\n}\n"],"sourceRoot":"/source/"}